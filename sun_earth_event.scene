local assetHelper = asset.require('util/asset_helper')
local sceneHelper = asset.require('util/scene_helper')
local propertyHelper = asset.require('util/property_helper')

-- Specifying which other assets should be loaded in this scene
asset.require('spice/base')
assetHelper.requestAll(asset, 'scene/solarsystem/sun')
asset.require('scene/solarsystem/planets')
assetHelper.requestAll(asset, 'scene/digitaluniverse')

-- Load default key bindings applicable to most scenes
asset.require('util/default_keybindings')
asset.request('customization/globebrowsing')

-- We need to specify paths to J2000 images of satellites before requesting the mission_imagery assets:
-- @TODO(abock):  Instructions on how to prepare images
local SolarImageryBasePath = "D:/CCMC/solarbrowsingdata/"
SOHOImageryDataPath    = SolarImageryBasePath .. "event/SOHO"
assetHelper.requestAll(asset, './soho')

SDOImageryDataPath     = SolarImageryBasePath .. "event/SDO"
assetHelper.requestAll(asset, './sdo')

StereoAImageryDataPath = SolarImageryBasePath .. "event/STEREOA"
StereoBImageryDataPath = SolarImageryBasePath .. "event/STEREOB"
assetHelper.requestAll(asset, './stereo')



-- We need to specify paths to the prepared fieldline files before requesting the BATSRUS, ENLIL, and PFSS fieldline assets:
-- @TODO(abock):  Instructions on how to prepare fieldline files
local FieldLineBasePath = "D:/CCMC/fieldlinedata/"
-- local FieldLineBasePath = "D:/fieldlinedata/FieldlineBinaries/"
BATSRUSPaths = {
    MagneticOpenClosed = FieldLineBasePath .. "batsrus/lutz_july_event/downsampled4/magnetic_fieldlines/open-closed/",
    VelocityFlowlinesUpstream = FieldLineBasePath .. "batsrus/lutz_july_event/downsampled4/velocity_flowlines/upstream-old/",
    VelocityFlowlinesUpstreamNew = FieldLineBasePath .. "batsrus/lutz_july_event/downsampled4/velocity_flowlines/upstream/",
    ArtificialMagnetic = FieldLineBasePath .. "/batsrus/lutz_model_run/downsampled4/magnetic_fieldlines/",
    ArtificialVelocityFlowlines = FieldLineBasePath .. "/batsrus/lutz_model_run/downsampled4/velocity_flowlines/"
}
asset.request('./fieldlines/batsrus')
ENLILPaths = {
    EqPlane011AU1 = FieldLineBasePath .. "enlil/july2012/downsampled40/011AU_eq_plane_1/",
    EqPlane011AU2 = FieldLineBasePath .. "enlil/july2012/downsampled40/011AU_eq_plane_2/",
    Lat4011AU1 = FieldLineBasePath .. "enlil/july2012/downsampled40/011AU_lat4_1/",
    Lat4011AU2 = FieldLineBasePath .. "enlil/july2012/downsampled40/011AU_lat4_2/",
    Earth = FieldLineBasePath .. "enlil/july2012/downsampled40/earth/",
    StereoA = FieldLineBasePath .. "enlil/july2012/downsampled40/stereoa/"
}
asset.request('./fieldlines/enlil')
PFSSPaths = {
    SolarSoft = FieldLineBasePath .. "pfss/leilas_solar_soft_july_12_2012/"
}
asset.request('./fieldlines/pfss')

-- This has to be requested after all of the solary imagery values
asset.request('./sun/sun')

asset.request('scene/solarsystem/planets/earth/satellites/communications/geostationary')


-- Keybindings that are specific for this scene
local Keybindings = {
    {
        Key = "F1",
        Command =
[[local b = openspace.getPropertyValue('Modules.ImGUI.Main.Enabled');
openspace.setPropertyValueSingle('Modules.ImGUI.Main.Enabled', not b);
openspace.setPropertyValueSingle('Modules.ImGUI.Main.IsHidden', b);]],
        Documentation = "Shows or hides the entire user interface",
        Local = true
    },
    {
        Key = "F2",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_*_Image*.renderable.enableFrustum', true)",
        Documentation = "Enables all Solar Imagery Frustums",
        Local = false
    },
    {
        Key = "Shift+F2",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_*_Image*.renderable.enableFrustum', false)",
        Documentation = "Disables all Solar Imagery Frustums",
        Local = false
    },
    {
        Key = "F3",
        Command = "openspace.setPropertyValue('Scene.SolarImagery*.renderable.planeOpacity', 1.0, 3)",
        Documentation = "Enables all Solar Imagery Planes",
        Local = false
    },
    {
        Key = "Shift+F3",
        Command = "openspace.setPropertyValue('Scene.SolarImagery*.renderable.planeOpacity', 0.0, 3)",
        Documentation = "Disables Solar Imagery Planes",
        Local = false
    },
    {
        Key = "F4",
        Command = "openspace.setPropertyValue('Scene.SolarImagery*.renderable.moveFactor', 1.0, 3)",
        Documentation = "Move Solar Imagery Planes into Sun",
        Local = false
    },
    {
        Key = "Shift+F4",
        Command = "openspace.setPropertyValue('Scene.SolarImagery*.renderable.moveFactor', 0.9, 3)",
        Documentation = "Move Solar Imagery Planes away from Sun",
        Local = false
    },
    {
        Key = "F5",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_EarthMarker_Marker.renderable.Enabled', true)",
        Documentation = "Enable Earth marker",
        Local = false
    },
    {
        Key = "Shift+F5",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_EarthMarker_Marker.renderable.Enabled', false)",
        Documentation = "Disable Earth marker",
        Local = false
    },
    {
        Key = "F6",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_ACE_Marker.renderable.Enabled', true)",
        Documentation = "Enable ACE Marker",
        Local = false
    },
    {
        Key = "Shift+F6",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_ACE_Marker.renderable.Enabled', false)",
        Documentation = "Disable ACE Marker",
        Local = false
    },


    -- Satellites & Frustums
    -- Stereo:   Q, W, E, ...
    {
        Key = "Q",
        Command = "openspace.setPropertyValue('Scene.Stereo_*_Trail.renderable.Enabled', true)",
        Documentation = "Show Stereo Orbits",
        Local = false
    },
    {
        Key = "Shift+Q",
        Command = "openspace.setPropertyValue('Scene.Stereo_*_Trail.renderable.Enabled', false)",
        Documentation = "Hide Stereo Orbits",
        Local = false
    },
    {
        Key = "W",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_L*.renderable.Enabled', true)",
        Documentation = "Show Stereo Labels",
        Local = false
    },
    {
        Key = "Shift+W",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_L*.renderable.Enabled', false)",
        Documentation = "Hide Stereo Labels",
        Local = false
    },
    {
        Key = "E",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_*_Image_*.renderable.enableFrustum', true)",
        Documentation = "Show all Stereo Frustums",
        Local = false
    },
    {
        Key = "Shift+E",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_*_Image_*.renderable.enableFrustum', false)",
        Documentation = "Hide all Stereo Frustums",
        Local = false
    },
    {
        Key = "R",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.Enabled', true)",
        Documentation = "Show Stereo A EUV Image",
        Local = false
    },
    {
        Key = "Shift+R",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.Enabled', false)",
        Documentation = "Show Stereo A EUV Image",
        Local = false
    },
    {
        Key = "T",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.Enabled', true)",
        Documentation = "Show Stereo B EUV Image",
        Local = false
    },
    {
        Key = "Shift+T",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.Enabled', false)",
        Documentation = "Show Stereo B EUV Image",
        Local = false
    },
    {
        Key = "Y",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoA_Image_COR.renderable.Enabled', true)",
        Documentation = "Show Stereo A COR Image",
        Local = false
    },
    {
        Key = "Shift+Y",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoA_Image_COR.renderable.Enabled', false)",
        Documentation = "Show Stereo A COR Image",
        Local = false
    },
    {
        Key = "U",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoB_Image_COR.renderable.Enabled', true)",
        Documentation = "Show Stereo B COR Image",
        Local = false
    },
    {
        Key = "Shift+U",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoB_Image_COR.renderable.Enabled', false)",
        Documentation = "Show Stereo B COR Image",
        Local = false
    },



    -- SDO: A, S, D, ...
    {
        Key = "A",
        Command = "openspace.setPropertyValue('Scene.SDOTrail.renderable.Enabled', true)",
        Documentation = "Enable SDO Orbit",
        Local = false
    },
    {
        Key = "Shift+A",
        Command = "openspace.setPropertyValue('Scene.SDOTrail.renderable.Enabled', false)",
        Documentation = "Disable SDO Orbit",
        Local = false
    },
    {
        Key = "S",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_SDO_Marker.renderable.Enabled', true)",
        Documentation = "Show SDO Labels",
        Local = false
    },
    {
        Key = "Shift+S",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_SDO_Marker.renderable.Enabled', false)",
        Documentation = "Hide SDO Labels",
        Local = false
    },
    {
        Key = "D",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_SDO_Image_AIA.renderable.enableFrustum', true)",
        Documentation = "Show SDO Frustum",
        Local = false
    },
    {
        Key = "Shift+D",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_SDO_Image_AIA.renderable.enableFrustum', false)",
        Documentation = "Hide SDO Frustum",
        Local = false
    },
    -- Skipping F for friction reasons
    {
        Key = "G",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_SDO_Image*.renderable.Enabled', true)",
        Documentation = "Show SDO Image",
        Local = false
    },
    {
        Key = "Shift+G",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_SDO_Image*.renderable.Enabled', false)",
        Documentation = "Hide SDO Image",
        Local = false
    },


    -- SOHO: Z, X, C, ...
    {
        Key = "Z",
        Command = "openspace.setPropertyValue('Scene.SOHOTrail.renderable.Enabled', true)",
        Documentation = "Enable SOHO Orbit",
        Local = false
    },
    {
        Key = "Shift+Z",
        Command = "openspace.setPropertyValue('Scene.SOHOTrail.renderable.Enabled', false)",
        Documentation = "Disable SOHO Orbit",
        Local = false
    },
    {
        Key = "X",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Soho_Marker.renderable.Enabled', true)",
        Documentation = "Show SOHO Labels",
        Local = false
    },
    {
        Key = "Shift+X",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Soho_Marker.renderable.Enabled', false)",
        Documentation = "Hide SOHO Labels",
        Local = false
    },
    {
        Key = "C",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Soho_Image_*.renderable.enableFrustum', true)",
        Documentation = "Show SOHO Frustum",
        Local = false
    },
    {
        Key = "Shift+C",
        Command = "openspace.setProperytyValue('Scene.SolarImagery_Soho_Image_*.renderable.enableFrustum', false)",
        Documentation = "Hide SOHO Frustum",
        Local = false
    },
    {
        Key = "V",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Soho_Image_C2.renderable.Enabled', true)",
        Documentation = "Show C2 Image",
        Local = false
    },
    {
        Key = "Shift+V",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Soho_Image_C2.renderable.Enabled', false)",
        Documentation = "Hide C2 Image",
        Local = false
    },
    {
        Key = "B",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Soho_Image_C3.renderable.Enabled', true)",
        Documentation = "Show C3 Image",
        Local = false
    },
    {
        Key = "Shift+B",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Soho_Image_C3.renderable.Enabled', false)",
        Documentation = "Hide C3 Image",
        Local = false
    },


    -- Delta times and predefined times
    {
        Key = "KP_7",
        Command = "openspace.time.setTime('2012 JUL 01 00:00:00.000')",
        Documentation = "Sets time to 2012 07 01 00:00:00.000",
        Local = false
    },
    {
        Key = "Shift+KP_7",
        Command = "openspace.time.setTime('2012 JUL 04 00:00:00.000')",
        Documentation = "Sets time to 2012 07 04 00:00:00.000",
        Local = false
    },
    {
        Key = "KP_8",
        Command = "openspace.time.setTime('2012 JUL 12 19:10:15.000')",
        Documentation = "Sets time to 2012 07 12 19:10:15.000",
        Local = false
    },
    {
        Key = "Shift+KP_8",
        Command = "openspace.time.setTime('2012 JUL 14 06:00:00.000')",
        Documentation = "Sets time to 2012 07 14 06:00:00.000",
        Local = false
    },
    {
        Key = "KP_9",
        Command = "openspace.time.setTime('2012 JUL 15 10:00:00.000')",
        Documentation = "Sets time to 2012 07 15 10:00:00.000",
        Local = false
    },
    {
        Key = "KP_4",
        Command = "openspace.time.setTime('2011 JAN 01 00:00:00.000')",
        Documentation = "Sets time to 2011 01 12 00:00:00.000",
        Local = false
    },
    {
        Key = "Shift+KP_4",
        Command = "openspace.time.setTime('2000 JAN 01 04:00:00.000')",
        Documentation = "Sets time to 2000 01 01 04:00:00.000",
        Local = false
    },
    {
        Key = "KP_5",
        Command = "openspace.time.setTime('2000 JAN 01 06:57:00.000')",
        Documentation = "Sets time to 2000 01 01 06:57:00.000",
        Local = false
    },
    {
        Key = "Shift+KP_5",
        Command = "openspace.time.setTime('2000 JAN 01 05:30:00.000')",
        Documentation = "Sets time to 2000 01 01 05:30:00.000",
        Local = false
    },
    {
        Key = "KP_1",
        Command = "openspace.time.setDeltaTime(1500)",
        Documentation = "Set delta time to 1500",
        Local = false
    },
    {
        Key = "KP_2",
        Command = "openspace.time.setDeltaTime(0.001)",
        Documentation = "Sets delta time to 0.001",
        Local = false
    },


    -- Operational commands
    {
        Key = "Shift+F1",
        Command = "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.currentActiveInstrumentProperty', 'SECCHI_EUVI_304');openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.currentActiveInstrumentProperty', 'SECCHI_EUVI_304');openspace.setPropertyValue('Scene.SolarImagery_SDO_Image_AIA.renderable.currentActiveInstrumentProperty', 'AIA_AIA_304');",
        Documentation = "Sets all EUV to 304",
        Local = false
    },
    {
        Key = "Shift+F2",
        Command = propertyHelper.invert('Scene.SolarImagery_Stereo_O_StereoA_Trail.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_O_StereoB_Trail.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_L_StereoA_Marker.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_L_StereoB_Marker.renderable.Enabled') ..
                  "openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.currentActiveInstrumentProperty', 'SECCHI_EUVI_195');openspace.setPropertyValue('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.currentActiveInstrumentProperty', 'SECCHI_EUVI_195');" ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.enableFrustum'),
        Documentation = "Activate Stereo A + B + EUV + Orbits + Labels + Frustums",
        Local = false
    },
    {
        Key = "Shift+F3",
        Command = propertyHelper.invert('Scene.SolarImagery_SDO_Image_AIA.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.Enabled') ..
                  "openspace.setPropertyValue('Scene.SolarImagery_SDO_Image_AIA.renderable.currentActiveInstrumentProperty', 'HMI_HMI_magnetogram');openspace.setPropertyValue('Scene.SolarImagery_*_Image*.renderable.planeOpacity', 1, 3)",
        Documentation = "Turn off SDO Frustum, stereo frustums, switch to HMI magnetigram, set plane opacity to 1",
        Local = false
    },
    {
        Key = "Shift+F4",
        Command = propertyHelper.invert('Scene.SolarImagery_SDO_Image_AIA.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_COR.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_COR.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Image_C2.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Image_C3.renderable.enableFrustum'),
        Documentation = "Invert display frustums",
        Local = false
    },
    {
        Key = "Shift+F5",
        Command = propertyHelper.invert('Scene.SolarImagery_SDO_Trail.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_SDO_Marker.renderable.Enabled'),
        Documentation = "Toggle SDO Trail and marker SDO",
        Local = false
    },
    {
        Key = "Shift+F6",
        Command = propertyHelper.invert('Scene.SolarImagery_SDO_Image_AIA.renderable.enableFrustum') ..
                  --"openspace.setPropertyValue('SolarImagery_*_Image*.renderable.moveFactor', 0.85)" ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.Enabled') ..
                  "openspace.setPropertyValue('Scene.SolarImagery_*_Image*.renderable.moveFactor', 0.9)" ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.Enabled') ..
                  "openspace.setPropertyValue('Scene.SolarImagery_*_Image*.renderable.planeOpacity', 100)" ..
                  "openspace.setPropertyValue('Scene.SolarImagery_SDO_Image_AIA.renderable.currentActiveInstrumentProperty', 'HMI_HMI_continuum');",
        Documentation = "Enable SDO frustum and switch to Continuum",
        Local = false
    },
    {
        Key = "Shift+F7",
        Command = propertyHelper.invert('Scene.SolarImagery_Soho_Image_C2.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Image_C3.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Image_C2.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Image_C3.renderable.enableFrustum') ..
                  --helper.property.invert('Scene.SolarImagery_SDO_Image_AIA.renderable.enableFrustum') ..
                  propertyHelper.invert('Scene.SolarImagery_SDO_Marker.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Marker.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Trail.renderable.Enabled'),
        Documentation = "Toggle SOHO",
        Local = false
    },
    {
        Key = "Shift+F8",
        Command = propertyHelper.invert('Scene.SolarImagery_SDO_Image_AIA.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_EUV.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_EUV.renderable.Enabled'),
        Documentation = "Disable EUV",
        Local = false
    },
    {
        Key = "Shift+F9",
        Command = propertyHelper.invert('Scene.SolarImagery_Soho_Image_C2.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Image_C3.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoA_Image_COR.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_StereoB_Image_COR.renderable.Enabled'),
        Documentation = "Toggle Corona Graphs",
        Local = false
    },
    {
        Key = "Shift+F10",
        Command = propertyHelper.invert('Scene.SolarImagery_Stereo_O_StereoA_Trail.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Stereo_O_StereoB_Trai.renderable.Enabledl') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Marker.renderable.Enabled') ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Trail.renderable.Enabled') ..
                  "openspace.setPropertyValue('Scene.SolarImagery_SDO_Image_AIA.renderable.currentActiveInstrumentProperty', 'HMI_HMI_magnetogram');" ..
                  "openspace.time.setTime('2012 JUL 12 19:10:15.000')" ..
                  propertyHelper.invert('Scene.SolarImagery_Soho_Image_C3.renderable.Enabled') ..
                  "openspace.setPropertyValue('Scene.FL_PFSS.renderable.Enabled', true);",
        Documentation = "Turn off stereo a, b, soho trails, turn off soho marker and switch to hmi continuum and turn on PFSS, set to PFSS Time",
        Local = false
    },
   {
        Key = "Shift+F11",
        Command = propertyHelper.invert('Scene.FL_PFSS.renderable.Enabled'),
        Documentation = "Toggle PFSS",
        Local = false
    },
    {
        Key = "Shift+F12",
        Command = "openspace.time.setDeltaTime(0.001)" .. propertyHelper.invert('Scene.FL_PFSS.renderable.showParticles'),
        Documentation = "Toggle particles",
        Local = false
    },
    {
        Key = "Shift+o",
        Command = propertyHelper.invert('Scene.SolarImagery_EarthMarker_Marker.renderable.Enabled'),
        Documentation = "Toggle Earth Marker",
        Local = false
    },
    {
        Key = "Shift+l",
        Command = propertyHelper.invert('Scene.FL_ENLIL_slice_eqPlane_011AU_1.renderable.Enabled') ..
                  propertyHelper.invert('Scene.FL_ENLIL_slice_eqPlane_011AU_2.renderable.Enabled') ..
                  propertyHelper.invert('Scene.FL_ENLIL_slice_lat4_011AU_1.renderable.Enabled') ..
                  propertyHelper.invert('Scene.FL_ENLIL_slice_lat4_011AU_2.renderable.Enabled'),
        Documentation = "Toggle Enlil",
        Local = false
    },
    {
        Key = "Shift+p",
        Command = propertyHelper.invert('Scene.FL_PFSS.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_BATSRUS_J12_OpenClosed.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_BATSRUS_J12_FlowLines.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_BATSRUS_Artificial_SingleStepFlowLines.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_BATSRUS_Artificial_SingleStepOpenClosed.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_ENLIL_slice_eqPlane_011AU_1.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_ENLIL_slice_eqPlane_011AU_2.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_ENLIL_slice_lat4_011AU_1.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_ENLIL_slice_lat4_011AU_2.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_ENLIL_earth.renderable.additiveBlending') ..
                  propertyHelper.invert('Scene.FL_ENLIL_stereoa.renderable.additiveBlending'),
        Documentation = "Toggle Additive Blending",
        Local = false
    },
    {
        Key = "SEMICOLON",
        Command = propertyHelper.invert("Scene.JupiterTrail.renderable.Enabled") ..
                  propertyHelper.invert("Scene.VenusTrail.renderable.Enabled") ..
                  propertyHelper.invert("Scene.SaturnTrail.renderable.Enabled") ..
                  propertyHelper.invert("Scene.MarsTrail.renderable.Enabled"),
        Documentation = "Turn off planet trails",
        Local = false
    },
    {
        Key = "LEFT_BRACKET",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);",
        Documentation = "Stop Looping",
        Local = false
    },
    {
        Key = "Shift+KP_1",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 0);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 1",
        Local = false
    },
    {
        Key = "Shift+KP_2",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 1);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 2",
        Local = false
    },
    {
        Key = "Shift+KP_3",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 2);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 3",
        Local = false
    },
    {
        Key = "Shift+KP_4",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 3);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 4",
        Local = false
    },
    {
        Key = "Shift+KP_5",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 4);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 5",
        Local = false
    },
    {
        Key = "Shift+KP_6",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 5);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 6",
        Local = false
    },
    {
        Key = "Shift+KP_7",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 6);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 7",
        Local = false
    },
    {
        Key = "Shift+KP_8",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 7);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 8",
        Local = false
    },
    {
        Key = "Shift+KP_9",
        Command = "openspace.setPropertyValue('Scene.Sun_Projection.renderable.loopId', 8);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', false);" ..
                  "openspace.setPropertyValue('Scene.Sun_Projection.renderable.activateLooping', true);",
        Documentation = "Activate Loop 9",
        Local = false
    }
}


local earthAsset = asset.require('scene/solarsystem/planets/earth/earth')

asset.onInitialize(function ()
    openspace.time.setTime("2012 JUL 01 00:00:00.000")

    -- Clearing before resetting the new bindings
    -- openspace.clearKey("F1")
    -- openspace.clearKey("F2")
    -- openspace.clearKey("F3")
    -- openspace.clearKey("F4")

    sceneHelper.bindKeys(Keybindings)

    openspace.setDefaultDashboard()
    openspace.setDefaultGuiSorting()

    openspace.globebrowsing.loadWMSServersFromFile(
        openspace.absPath("${DATA}/globebrowsing_servers.lua")
    )

    openspace.markInterestingNodes({
        "Earth", "Sun", "SDO", "Moon"
    })

    -- Only enable the (currently) three GOES satellites
    openspace.setPropertyValue("Scene.geo*.renderable.Enabled", false)
    openspace.setPropertyValue("Scene.geo_GOES*.renderable.Enabled", true)
    openspace.setPropertyValue("Scene.geo_GOES_*_trail.renderable.Fade", 0.6)

    openspace.setPropertyValue('Scene.SolarImagery_*_Image*.renderable.planeOpacity', 0)


    -- openspace.addVirtualProperty(
    --     "BoolProperty",
    --     "Show Trails",
    --     "Scene.*Trail.renderable.Enabled",
    --     "Disable or enable all trails of the scene at the same time",
    --     true,
    --     nil,
    --     nil
    -- )


    -- openspace.addVirtualProperty("BoolProperty", "Activate Looping", "VirtualPropertyManager.Scene.Sun_Projection.renderable.activateLooping", "", false, nil, nil)
    -- openspace.addVirtualProperty("IntProperty",  "Loop Id", "VirtualPropertyManager.Scene.Sun_Projection.renderable.loopId", "", 0, 0, 9)
    -- Display Frustums
    -- openspace.addVirtualProperty("BoolProperty", "Display Frustums", "VirtualPropertyManager.Scene.SolarImagery_*_Image*.renderable.enableFrustum", "", false, nil, nil)
    -- Display Markers
    -- openspace.addVirtualProperty("BoolProperty", "Display Markers", "VirtualPropertyManager.Scene.SolarImagery_*_Marker.renderable.enabled", "", true, nil, nil)
    -- openspace.addVirtualProperty("FloatProperty", "Plane Opacity", "SolarImagery*.renderable.planeOpacity", "", 1.0, 0.0, 1.0)
    -- openspace.addVirtualProperty("FloatProperty", "Move Factor", "SolarImagery*.renderable.moveFactor", "", 0.9, 0.0, 1.0)
    -- openspace.addVirtualProperty("BoolProperty",  "Verbose All Planes", "SolarImagery*.renderable.verboseMode", "", false, nil, nil)

    -- openspace.addVirtualProperty("IntProperty",   "Update Interval", "SolarImagery*.renderable.minRealTimeUpdateInterval", "", 65, 0, 1000)

    --    -- ===================================================== STEREO A & B ============================================================
    -- -- Stereo Orbits
    -- openspace.addVirtualProperty("BoolProperty",  "Stereo Orbits", "SolarImagery_Stereo_O*.renderable.enabled", "", false, nil, nil)
    -- -- Stereo Labels
    -- openspace.addVirtualProperty("BoolProperty",  "Stereo Labels", "SolarImagery_Stereo_L*.renderable.enabled", "", false, nil, nil)

    -- -- Stereo Frustums
    -- openspace.addVirtualProperty("BoolProperty",  "Stereo Frustums", "SolarImagery_Stereo_*_Image_*.renderable.enableFrustum", "", false, nil, nil)




    -- -- SDO Orbit
    -- openspace.addVirtualProperty("BoolProperty",  "SDO Orbit",   "SolarImagery_SDO_Trail.renderable.enabled", "", false, nil, nil)
    -- -- SDO Label
    -- openspace.addVirtualProperty("BoolProperty",  "SDO Label", "SolarImagery_SDO_Marker.renderable.enabled", "", false, nil, nil)

    -- -- Soho Orbit
    -- openspace.addVirtualProperty("BoolProperty",  "SOHO Orbit",   "SolarImagery_Soho_Trail.renderable.enabled", "", false, nil, nil)
    -- -- Soho Label
    -- openspace.addVirtualProperty("BoolProperty",  "SOHO Label",   "SolarImagery_Soho_Marker.renderable.enabled", "", false, nil, nil)

    -- -- Stereo A
    -- openspace.addVirtualProperty("BoolProperty",  "Stereo A EUV", "SolarImagery_Stereo_StereoA_Image_EUV.renderable.enabled", "", false, nil, nil)
    -- openspace.addVirtualProperty("BoolProperty",  "Stereo A COR2",  "SolarImagery_Stereo_StereoA_Image_COR.renderable.enabled", "", false, nil, nil)
    -- -- Stereo B
    -- openspace.addVirtualProperty("BoolProperty",  "Stereo B EUV", "SolarImagery_Stereo_StereoB_Image_EUV.renderable.enabled", "", false, nil, nil)
    -- openspace.addVirtualProperty("BoolProperty",  "Stereo B COR2", "SolarImagery_Stereo_StereoB_Image_COR.renderable.enabled", "", false, nil, nil)

    --    -- ======================================================= SDO ===================================================================
    -- -- SDO Frustum
    -- openspace.addVirtualProperty("BoolProperty",  "SDO Frustum", "SolarImagery_SDO_Image_AIA.renderable.enableFrustum", "", false, nil, nil)
    -- -- SDO
    -- openspace.addVirtualProperty("BoolProperty",  "SDO",   "SolarImagery_SDO_Image*.renderable.enabled", "", false, nil, nil)


    -- -- ========================================================== SOHO ===================================================================
    -- -- Soho Frustum
    -- openspace.addVirtualProperty("BoolProperty",  "SOHO Frustum",   "SolarImagery_Soho_Image_*.renderable.enableFrustum", "", false, nil, nil)
    -- -- SOHO
    -- openspace.addVirtualProperty("BoolProperty",  "SOHO C2", "SolarImagery_Soho_Image_C2.renderable.enabled", "", false, nil, nil)
    -- openspace.addVirtualProperty("BoolProperty",  "SOHO C3", "SolarImagery_Soho_Image_C3.renderable.enabled", "", false, nil, nil)

    -- openspace.addVirtualProperty("BoolProperty",  "Earth Label",   "SolarImagery_EarthMarker_Marker.renderable.enabled", "", true, nil, nil)
    -- openspace.addVirtualProperty("BoolProperty", "ACE Label", "SolarImagery_ACE_Marker.renderable.enabled", "", false, nil, nil)


    openspace.navigation.setCameraState({
        Focus = earthAsset.Earth.Identifier,
        Position = { 0, 0, 0 },
        Rotation = { 0.758797, 0.221490, -0.605693, -0.091135 },
    })

    openspace.globebrowsing.goToGeo(58.5877, 16.1924, 20000000)
end)

asset.onDeinitialize(function ()
    sceneHelper.unbindKeys(Keybindings)

    openspace.removeVirtualProperty("*Trail.renderable.Enabled")

    openspace.removeInterestingNodes({
        "Earth", "Mars", "Moon"
    })
end)
